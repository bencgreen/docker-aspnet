#!/usr/bin/with-contenv sh

set -euo pipefail


#======================================================================================================================
# Verify ASPNET_ASSEMBLY is set.
#======================================================================================================================

[[ -z "${ASPNET_ASSEMBLY}" ]] && bcg-error "run: ASPNET_ASSEMBLY environment variable must be set."


#======================================================================================================================
# Verify ASPNET_ASSEMBLY exists before running it.
#======================================================================================================================

if [ -f ${ASPNET_APP_ASSEMBLY} ] ; then

    bcg-echo "Starting ASP.NET application"
    bcg-debug "run: ${ASPNET_APP_ASSEMBLY}"

    /usr/bin/dotnet ${ASPNET_APP_ASSEMBLY}

else

    SLEEP=30
    bcg-notok "run: ${ASPNET_APP_ASSEMBLY} not found - sleeping for ${SLEEP}s."
    sleep ${SLEEP}

fi
